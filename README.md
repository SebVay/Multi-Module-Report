# Multi Modules Report

[![MIT License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Jacoco](https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/SebVay/CI-CD-Badges/refs/heads/main/Multi-Module-Report/badges/coverage.json)](https://sebvay.github.io/CI-CD-Badges/Multi-Module-Report/)
![GitHub branch check runs](https://img.shields.io/github/check-runs/SebVay/Multi-Module-Report/main)

Generate [beautiful and attractive](https://github.com/SebVay/Multi-Module-Report/pull/1), modules report 
on your Pull Requests using Github Actions or [Danger Kotlin](https://danger.systems/kotlin/).

> [!WARNING]
> It is still under active development and is not yet published.

## Example Output

<details>
  <summary>Here's an example of the report generated by this library</summary>
  <img width="1403" height="976" alt="Capture d'Ã©cran 2025-08-21 221936" src="https://github.com/user-attachments/assets/5de3d71b-25fa-48b4-84cc-ddade653d184" />
</details>  

## Features

- **Module-centric view of changes**: Understand the impact of a PR at a glance.
- **Host-friendly reports**: Generates clean Markdown/HTML tables for GitHub (and more hosts to come).
- **Customizable**:
    - Add custom titles and footers.
    - Toggle file links, circle indicators, and line indicators.
    - Filter or rename modules using an interceptor.
- **Easy to integrate**: Simple, type-safe Kotlin DSL for configuration.

## How it works

1. **File analysis**: Danger Kotlin provides the list of created, modified, and deleted files in the PR.
2. **Module grouping**: Files are grouped into modules based on their path. The default convention uses the path up to `/src/` as the module name (e.g., `app/feature/login/src/main/...` becomes `app:feature:login`).
3. **Report generation**: A report is generated and posted as a comment on the PR.

## Installation & Run

### With Danger Kotlin

This library can be used in any environment that runs Danger Kotlin:
**Set up Danger Kotlin**: Follow the instructions on the [Danger Kotlin website](https://danger.systems/kotlin/) to set
up Danger in your CI environment.

This library will be published on Maven Central. To use it, add the following to your `Dangerfile.df.kts`:

```kotlin
@file:DependsOn("com.sebastmar:multi-module-report-danger:<latest-version>")

import com.sebastmar.module.report.github.githubModuleReport
import systems.danger.kotlin.danger

danger(args) {
    githubModuleReport()
}
```

Replace `<latest-version>` with the latest version from Maven Central

### With Github Action

Currently, the primary way to integrate this library is by using the `@file:DependsOn` annotation in your `Dangerfile.df.kts`. 
However, a GitHub Action is planned for the near future to provide a more seamless integration experience.


## Configuration

You can customize the report using the `githubModuleReport` DSL:

```kotlin
import com.sebastmar.module.report.configuration.ModulesInterceptor
import com.sebastmar.multi.module.report.danger.githubModuleReport

danger(args) {
    githubModuleReport {

        reportStrings {
            // Add a title to the report (default)
            topSection = "# Updated Modules"

            // Add a footer to the report (default)
            bottomSection = "_Generated by [multi-module-report-danger](https://github.com/SebVay/Multi-Module-Report)_"            
        }

        // Add links to each file's diff (default)
        linkifyFiles = true

        // Show ðŸŸ¢/ðŸŸ¡/ðŸ”´ with file names (default)
        showCircleIndicators = true

        // Show (+/-) totals in headers (default)
        showLineIndicators = true

        // Intercept the modules and modify them before being displayed on the UI (default: NoOpModulesInterceptor)
        modulesInterceptor { modules ->
            modules.filterNot { it.name == "domain" }
        }
    }
}
```

## Host Support

- **GitHub**: Fully supported via `githubModuleReport()`.
- **GitLab / Bitbucket**: Not done yet, but planned for the future and welcome to contribution.

## Contributing

Contributions are welcome!
The project has been developed in order to add new hosts (such as Bitbucket / Gitlab) or features seamlessly.

Please see the [Contributing Guidelines](CONTRIBUTING.md) and [Code of Conduct](CODE_OF_CONDUCT.md) for more
information.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.
